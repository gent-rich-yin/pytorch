includes:
include(${CMAKE_CURRENT_LIST_DIR}/ProtoBuf.cmake)
include(${CMAKE_CURRENT_LIST_DIR}/public/mkl.cmake)
include(${CMAKE_CURRENT_LIST_DIR}/Modules/FindOpenMP.cmake)
include(${CMAKE_CURRENT_LIST_DIR}/public/mkldnn.cmake)
include(${CMAKE_CURRENT_LIST_DIR}/FlatBuffers.cmake)

include_directories:
include_directories(AFTER SYSTEM ${MKLDNN_INCLUDE_DIR})
include_directories(SYSTEM ${XNNPACK_INCLUDE_DIR})
include_directories(BEFORE SYSTEM ${CMAKE_CURRENT_LIST_DIR}/../third_party/googletest/googletest/include)
include_directories(BEFORE SYSTEM ${CMAKE_CURRENT_LIST_DIR}/../third_party/googletest/googlemock/include)
include_directories(SYSTEM ${ITT_INCLUDE_DIR})
include_directories(SYSTEM ${CMAKE_CURRENT_LIST_DIR}/../third_party/eigen)
include_directories(BEFORE SYSTEM ${CMAKE_CURRENT_LIST_DIR}/../third_party/tensorpipe/third_party/libuv/include)
include_directories(BEFORE SYSTEM ${CMAKE_CURRENT_LIST_DIR}/../third_party/gloo)
include_directories(BEFORE SYSTEM ${PROJECT_BINARY_DIR}/third_party/gloo)

Caffe2_DEPENDENCY_LIBS
list(APPEND Caffe2_DEPENDENCY_LIBS Threads::Threads)
list(APPEND Caffe2_DEPENDENCY_LIBS pthreadpool)
list(APPEND Caffe2_DEPENDENCY_LIBS cpuinfo)
list(APPEND Caffe2_DEPENDENCY_LIBS pytorch_qnnpack)
list(APPEND Caffe2_DEPENDENCY_LIBS nnpack)
list(APPEND Caffe2_DEPENDENCY_LIBS XNNPACK microkernels-prod)
list(APPEND Caffe2_DEPENDENCY_LIBS fbgemm)
list(APPEND Caffe2_DEPENDENCY_LIBS ${ITT_LIBRARIES})
list(APPEND Caffe2_DEPENDENCY_LIBS fp16)
list(APPEND Caffe2_DEPENDENCY_LIBS caffe2::openmp)
list(APPEND Caffe2_DEPENDENCY_LIBS tensorpipe)
list(APPEND Caffe2_DEPENDENCY_LIBS nlohmann)
list(APPEND Caffe2_DEPENDENCY_LIBS moodycamel)
list(APPEND Caffe2_DEPENDENCY_LIBS gloo)
list(APPEND Caffe2_DEPENDENCY_LIBS rt)
list(APPEND Caffe2_DEPENDENCY_LIBS fmt::fmt-header-only)
list(APPEND Caffe2_DEPENDENCY_LIBS kineto)


Caffe2_PUBLIC_DEPENDENCY_LIBS:
list(APPEND Caffe2_PUBLIC_DEPENDENCY_LIBS caffe2::mkl)

Caffe2_PRIVATE_DEPENDENCY_LIBS:
list(APPEND Caffe2_PRIVATE_DEPENDENCY_LIBS ${LAPACK_LIBRARIES})

Caffe2_DEPENDENCY_WHOLE_LINK_LIBS:
list(APPEND Caffe2_DEPENDENCY_WHOLE_LINK_LIBS onnx_library)

TORCH_PYTHON_LINK_LIBRARIES:
list(APPEND TORCH_PYTHON_LINK_LIBRARIES ${ITT_LIBRARIES})

CMAKE_CXX_FLAGS:
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -DUSE_PTHREADPOOL")
string(APPEND CMAKE_CXX_FLAGS " -DUSE_KINETO")
string(APPEND CMAKE_CXX_FLAGS " -DLIBKINETO_NOCUPTI")
string(APPEND CMAKE_CXX_FLAGS " -DLIBKINETO_NOROCTRACER")
string(APPEND CMAKE_CXX_FLAGS " -DLIBKINETO_NOXPUPTI=ON")

add_subdirectory:
add_subdirectory("${PTHREADPOOL_SOURCE_DIR}" "${CONFU_DEPENDENCIES_BINARY_DIR}/pthreadpool")
add_subdirectory("${CPUINFO_SOURCE_DIR}" "${CONFU_DEPENDENCIES_BINARY_DIR}/cpuinfo")
add_subdirectory("${PYTORCH_QNNPACK_SOURCE_DIR}" "${CONFU_DEPENDENCIES_BINARY_DIR}/pytorch_qnnpack")
add_subdirectory("${NNPACK_SOURCE_DIR}" "${CONFU_DEPENDENCIES_BINARY_DIR}/NNPACK")  # from External/nnpack.cmake
add_subdirectory("${XNNPACK_SOURCE_DIR}" "${CONFU_DEPENDENCIES_BINARY_DIR}/XNNPACK")
add_subdirectory(${CMAKE_CURRENT_LIST_DIR}/../third_party/googletest)
add_subdirectory(${CMAKE_CURRENT_LIST_DIR}/../third_party/benchmark)
add_subdirectory("${CAFFE2_THIRD_PARTY_ROOT}/fbgemm")
add_subdirectory("${FP16_SOURCE_DIR}" "${CONFU_DEPENDENCIES_BINARY_DIR}/FP16")
add_subdirectory(${PROJECT_SOURCE_DIR}/third_party/tensorpipe)
add_subdirectory(${CMAKE_CURRENT_LIST_DIR}/../third_party/gloo)
add_subdirectory(${CMAKE_CURRENT_LIST_DIR}/../third_party/onnx EXCLUDE_FROM_ALL)
add_subdirectory(${PROJECT_SOURCE_DIR}/third_party/fmt)
add_subdirectory("${CAFFE2_THIRD_PARTY_ROOT}/kineto/libkineto")

add_library:
add_library(pybind::pybind11 INTERFACE IMPORTED)
add_library(opentelemetry::api INTERFACE IMPORTED)
add_library(caffe2::openmp INTERFACE IMPORTED)
add_library(torch::nvtx3 INTERFACE IMPORTED)
add_library(httplib INTERFACE IMPORTED)
add_library(nlohmann INTERFACE IMPORTED)
add_library(moodycamel INTERFACE IMPORTED)

add_compile_options:
add_compile_options(-DTORCH_USE_LIBUV)
add_compile_options(-DCAFFE2_USE_GLOO)

add_definitions:
add_definitions(-DONNX_ML=1)
add_definitions(-DONNXIFI_ENABLE_EXT=1)
add_definitions(-DONNX_NAMESPACE=${ONNX_NAMESPACE})
add_definitions(-DHAVE_MMAP=1)
add_definitions(-D_FILE_OFFSET_BITS=64)
add_definitions(-DHAVE_SHM_OPEN=1)
add_definitions(-DHAVE_SHM_UNLINK=1)
add_definitions(-DHAVE_MALLOC_USABLE_SIZE=1)
add_definitions(-DUSE_EXTERNAL_MZCRC)
add_definitions(-DMINIZ_DISABLE_ZIP_READER_CRC32_CHECKS)


